'use strict';const Web=SIP.Web,api="https://metis-ai.herokuapp.com";let user=null,aor=null;const getAccount=async()=>{const a=await fetch(`${api}/sip`),{aor:b,endpoint:c}=await a.json();return{aor:b,endpoint:c}},createUser=async(a,b)=>{a=new Web.SimpleUser(b,{aor:a});await a.connect();await a.register();return a},runCall=async(a,b)=>{await fetch(`${api}/call`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({aor:a,name:b})})};
window.setAiUser=async()=>{const a=await getAccount(),b=a.endpoint;aor=a.aor;user=await createUser(aor,b);const c=new Audio;user.delegate={onCallReceived:async()=>{await user.answer();c.srcObject=user.remoteMediaStream;c.play()},onCallHangup:()=>{c.srcObject=null}}};window.enable_bot=async()=>{console.log("bot enable");runCall(aor,"friend").catch(()=>{})};window.disable_bot=async()=>{console.log("bot disable");await user.hangup().catch(()=>{})};